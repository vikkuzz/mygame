(()=>{var t={type:Phaser.AUTO,parent:"phaser-example",width:800,height:600,physics:{default:"arcade",arcade:{debug:!1,gravity:{y:0}}},scene:{preload:function(){this.load.image("ship","assets/spaceShips_001.png"),this.load.image("otherPlayer","assets/enemyBlack5.png"),this.load.image("star","assets/star_gold.png")},create:function(){var t=this;this.socket=io(),this.otherPlayers=this.physics.add.group(),this.socket.on("currentPlayers",(function(i){Object.keys(i).forEach((function(e){i[e].playerId===t.socket.id?function(t,s){t.ship=t.physics.add.image(s.x,s.y,"ship").setOrigin(.5,.5).setDisplaySize(53,40),"blue"===s.team?t.ship.setTint(255):t.ship.setTint(16711680),t.ship.setDrag(100),t.ship.setAngularDrag(100),t.ship.setMaxVelocity(200)}(t,i[e]):s(t,i[e])}))})),this.socket.on("newPlayer",(function(i){s(t,i)})),this.socket.on("disconnect",(function(s){t.otherPlayers.getChildren().forEach((function(t){s===t.playerId&&t.destroy()}))})),this.cursors=this.input.keyboard.createCursorKeys(),this.socket.on("playerMoved",(function(s){t.otherPlayers.getChildren().forEach((function(t){s.playerId===t.playerId&&(t.setRotation(s.rotation),t.setPosition(s.x,s.y))}))})),this.blueScoreText=this.add.text(16,16,"",{fontSize:"32px",fill:"#0000FF"}),this.redScoreText=this.add.text(584,16,"",{fontSize:"32px",fill:"#FF0000"}),this.socket.on("scoreUpdate",(function(s){t.blueScoreText.setText("Синие: "+s.blue),t.redScoreText.setText("Красные: "+s.red)})),this.socket.on("starLocation",(function(s){t.star&&t.star.destroy(),t.star=t.physics.add.image(s.x,s.y,"star"),t.physics.add.overlap(t.ship,t.star,(function(){this.socket.emit("starCollected")}),null,t)}))},update:function(){if(this.ship){this.cursors.left.isDown?this.ship.setAngularVelocity(-150):this.cursors.right.isDown?this.ship.setAngularVelocity(150):this.ship.setAngularVelocity(0),this.cursors.up.isDown?this.physics.velocityFromRotation(this.ship.rotation+1.5,100,this.ship.body.acceleration):this.ship.setAcceleration(0),this.physics.world.wrap(this.ship,5);var t=this.ship.x,s=this.ship.y,i=this.ship.rotation;!this.ship.oldPosition||t===this.ship.oldPosition.x&&s===this.ship.oldPosition.y&&i===this.ship.oldPosition.rotation||this.socket.emit("playerMovement",{x:this.ship.x,y:this.ship.y,rotation:this.ship.rotation}),this.ship.oldPosition={x:this.ship.x,y:this.ship.y,rotation:this.ship.rotation}}}}};function s(t,s){const i=t.add.sprite(s.x,s.y,"otherPlayer").setOrigin(.5,.5).setDisplaySize(53,40);"blue"===s.team?i.setTint(255):i.setTint(16711680),i.playerId=s.playerId,t.otherPlayers.add(i)}new Phaser.Game(t)})();